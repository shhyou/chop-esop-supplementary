#lang concolic-hop/lang
;; this file generated by convert-soft-contract.rkt using new-posn.sch as input
(require concolic-hop/ctc concolic-hop/lib concolic-hop/convert-it concolic-hop/strategy-queue concolic-hop/complex)
(define-lump
 L
 (0 'dist)
 (1 'draw-on/image)
 (2 'move-toward/speed)
 (3 'posn)
 (4 'x)
 (5 'y))
(define-concolic-test
 new-posn
 #:inputs
 (|M(image empty-scene (->s (list/s integer integer integer integer) (list/s integer integer integer integer) (struct/s _image any/s)) (-> number? number? image?))|
  (->s
   (list/s integer integer integer integer)
   (->s
    (list/s integer integer integer integer)
    (list/s
     integer
     (or/s
      (->s
       (list/s integer integer integer integer)
       (list/s integer integer integer integer))
      (list/s integer integer integer integer)
      boolean)))))
 (|M(image place-image (->s (struct/s _image any/s) (list/s integer integer integer integer) (list/s integer integer integer integer) (struct/s _image any/s) (struct/s _image any/s)) (-> image? number? number? image? image?))|
  (->s
   (list/s
    integer
    (or/s
     (->s
      (list/s integer integer integer integer)
      (list/s integer integer integer integer))
     (list/s integer integer integer integer)
     boolean))
   (->s
    (list/s integer integer integer integer)
    (->s
     (list/s integer integer integer integer)
     (->s
      (list/s
       integer
       (or/s
        (->s
         (list/s integer integer integer integer)
         (list/s integer integer integer integer))
        (list/s integer integer integer integer)
        boolean))
      (list/s
       integer
       (or/s
        (->s
         (list/s integer integer integer integer)
         (list/s integer integer integer integer))
        (list/s integer integer integer integer)
        boolean)))))))
 (|M(image circle (->s (list/s integer integer integer integer) string/s string/s (struct/s _image any/s)) (-> number? string? string? image?))|
  (->s
   (list/s integer integer integer integer)
   (->s
    integer
    (->s
     integer
     (list/s
      integer
      (or/s
       (->s
        (list/s integer integer integer integer)
        (list/s integer integer integer integer))
       (list/s integer integer integer integer)
       boolean))))))
 (|M(math sqrt (->s (list/s integer integer integer integer) (list/s integer integer integer integer)) (-> number? number?))|
  (->s
   (list/s integer integer integer integer)
   (list/s integer integer integer integer)))
 (|•(0 (->s (->s (list/s integer integer integer integer) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error"))))) dont-care/s) (-> (-> number? number? posn/c) dont-care/c))|
  (->s
   (->s
    (list/s integer integer integer integer)
    (->s
     (list/s integer integer integer integer)
     (list/s
      (->s
       (list/s
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (list/s integer integer integer integer))
        (->s
         (list/s
          integer
          (or/s
           (->s
            (list/s integer integer integer integer)
            (list/s integer integer integer integer))
           (list/s integer integer integer integer)
           boolean))
         (->s
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))))
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (->s
          (list/s integer integer integer integer)
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer)))))
        (->s
         integer
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer))))
        (->s integer (list/s integer integer integer integer))
        (->s integer (list/s integer integer integer integer)))
       (list/s integer integer integer integer))
      (->s
       (list/s
        integer
        (or/s
         (->s
          (list/s integer integer integer integer)
          (list/s integer integer integer integer))
         (list/s integer integer integer integer)
         boolean))
       (->s
        (list/s
         integer
         (or/s
          (->s
           (list/s integer integer integer integer)
           (list/s integer integer integer integer))
          (list/s integer integer integer integer)
          boolean))
        (list/s
         integer
         (or/s
          (->s
           (list/s integer integer integer integer)
           (list/s integer integer integer integer))
          (list/s integer integer integer integer)
          boolean))))
      (->s
       (list/s
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (list/s integer integer integer integer))
        (->s
         (list/s
          integer
          (or/s
           (->s
            (list/s integer integer integer integer)
            (list/s integer integer integer integer))
           (list/s integer integer integer integer)
           boolean))
         (->s
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))))
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (->s
          (list/s integer integer integer integer)
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer)))))
        (->s
         integer
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer))))
        (->s integer (list/s integer integer integer integer))
        (->s integer (list/s integer integer integer integer)))
       (->s
        (list/s integer integer integer integer)
        (list/s
         (->s
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer)))
          (list/s integer integer integer integer))
         (->s
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))))
         (->s
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer)))
          (->s
           (list/s integer integer integer integer)
           (list/s
            (->s boolean (list/s integer integer integer integer))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (->s
              (list/s
               integer
               (or/s
                (->s
                 (list/s integer integer integer integer)
                 (list/s integer integer integer integer))
                (list/s integer integer integer integer)
                boolean))
              (list/s
               integer
               (or/s
                (->s
                 (list/s integer integer integer integer)
                 (list/s integer integer integer integer))
                (list/s integer integer integer integer)
                boolean))))
            (->s
             boolean
             (->s (list/s integer integer integer integer) boolean))
            (->s integer boolean)
            (->s integer (list/s integer integer integer integer))
            (->s integer (list/s integer integer integer integer)))))
         (->s
          integer
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer))))
         (->s integer (list/s integer integer integer integer))
         (->s integer (list/s integer integer integer integer)))))
      (->s
       integer
       (list/s
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (list/s integer integer integer integer))
        (->s
         (list/s
          integer
          (or/s
           (->s
            (list/s integer integer integer integer)
            (list/s integer integer integer integer))
           (list/s integer integer integer integer)
           boolean))
         (->s
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))
          (list/s
           integer
           (or/s
            (->s
             (list/s integer integer integer integer)
             (list/s integer integer integer integer))
            (list/s integer integer integer integer)
            boolean))))
        (->s
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer)))
         (->s
          (list/s integer integer integer integer)
          (list/s
           (->s boolean (list/s integer integer integer integer))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (->s
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))
             (list/s
              integer
              (or/s
               (->s
                (list/s integer integer integer integer)
                (list/s integer integer integer integer))
               (list/s integer integer integer integer)
               boolean))))
           (->s boolean (->s (list/s integer integer integer integer) boolean))
           (->s integer boolean)
           (->s integer (list/s integer integer integer integer))
           (->s integer (list/s integer integer integer integer)))))
        (->s
         integer
         (list/s
          (->s boolean (list/s integer integer integer integer))
          (->s
           (list/s
            integer
            (or/s
             (->s
              (list/s integer integer integer integer)
              (list/s integer integer integer integer))
             (list/s integer integer integer integer)
             boolean))
           (->s
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))
            (list/s
             integer
             (or/s
              (->s
               (list/s integer integer integer integer)
               (list/s integer integer integer integer))
              (list/s integer integer integer integer)
              boolean))))
          (->s boolean (->s (list/s integer integer integer integer) boolean))
          (->s integer boolean)
          (->s integer (list/s integer integer integer integer))
          (->s integer (list/s integer integer integer integer))))
        (->s integer (list/s integer integer integer integer))
        (->s integer (list/s integer integer integer integer))))
      (->s integer (list/s integer integer integer integer))
      (->s integer (list/s integer integer integer integer)))))
   boolean))
 #:prop
 (prop-not-exn
  (λ ()
    (struct _image (impl))
    (define _empty-scene
      (convert-it
       |M(image empty-scene (->s (list/s integer integer integer integer) (list/s integer integer integer integer) (struct/s _image any/s)) (-> number? number? image?))|
       (->s
        (list/s integer integer integer integer)
        (list/s integer integer integer integer)
        (struct/s _image any/s))
       L
       #:arithmetic-coercion-both))
    (define _place-image
      (convert-it
       |M(image place-image (->s (struct/s _image any/s) (list/s integer integer integer integer) (list/s integer integer integer integer) (struct/s _image any/s) (struct/s _image any/s)) (-> image? number? number? image? image?))|
       (->s
        (struct/s _image any/s)
        (list/s integer integer integer integer)
        (list/s integer integer integer integer)
        (struct/s _image any/s)
        (struct/s _image any/s))
       L
       #:arithmetic-coercion-both))
    (define _circle
      (convert-it
       |M(image circle (->s (list/s integer integer integer integer) string/s string/s (struct/s _image any/s)) (-> number? string? string? image?))|
       (->s
        (list/s integer integer integer integer)
        string/s
        string/s
        (struct/s _image any/s))
       L
       #:arithmetic-coercion-both))
    (define-id-with-ctc (-> any/c boolean?) _image? image? bug bug)
    (define-id-with-ctc
     (-> c:number? c:number? image?)
     _empty-scene
     empty-scene
     bad-input
     bug)
    (define-id-with-ctc
     (-> image? c:number? c:number? image? image?)
     _place-image
     place-image
     bad-input
     bug)
    (define-id-with-ctc
     (-> c:number? string? string? image?)
     _circle
     circle
     bad-input
     bug)
    (define _sqrt
      (convert-it
       |M(math sqrt (->s (list/s integer integer integer integer) (list/s integer integer integer integer)) (-> number? number?))|
       (->s
        (list/s integer integer integer integer)
        (list/s integer integer integer integer))
       L
       #:arithmetic-coercion-both))
    (define (_min x y) (if (c:<= x y) x y))
    (define (_max x y) (if (c:>= x y) x y))
    (define (_abs x)
      (if (c:>= x (c:racket-number->c 0)) x (c:- (c:racket-number->c 0) x)))
    (define (_sqr x) (c:* x x))
    (define-id-with-ctc (-> c:number? c:number? c:number?) _min c:min bug bug)
    (define-id-with-ctc (-> c:number? c:number? c:number?) _max c:max bug bug)
    (define-id-with-ctc (-> c:number? c:number?) _abs c:abs bug bug)
    (define-id-with-ctc (-> c:number? c:number?) _sqrt c:sqrt bad-input bug)
    (define-id-with-ctc (-> c:number? c:number?) _sqr sqr bug bug)
    (define _WIDTH (c:racket-number->c 400))
    (define _HEIGHT (c:racket-number->c 400))
    (define _MT-SCENE "wrong")
    (define _PLAYER-SPEED (c:racket-number->c 4))
    (define _ZOMBIE-SPEED (c:racket-number->c 2))
    (define _ZOMBIE-RADIUS (c:racket-number->c 20))
    (define _PLAYER-RADIUS (c:racket-number->c 20))
    (define _PLAYER-IMG "wrong player-img")
    (define-ctc
     posn/c
     (->i
      ((msg (one-of/c 'x 'y 'posn 'move-toward/speed 'draw-on/image 'dist)))
      (res
       (msg)
       (cond
        ((equal? msg 'x) (-> c:number?))
        ((equal? msg 'y) (-> c:number?))
        ((equal? msg 'posn) (-> posn/c))
        ((equal? msg 'move-toward/speed) (-> posn/c c:number? posn/c))
        ((equal? msg 'draw-on/image) (-> _image? _image? _image?))
        ((equal? msg 'dist) (-> posn/c c:number?))
        (else "error")))))
    (define-ctc
     player/c
     (->i
      ((msg (one-of/c 'posn 'move-toward 'draw-on)))
      (res
       (msg)
       (cond
        ((equal? msg 'posn) (-> posn/c))
        ((equal? msg 'move-toward) (-> posn/c player/c))
        ((equal? msg 'draw-on) (-> _image? _image?))
        (else "error")))))
    (define-ctc
     zombie/c
     (->i
      ((msg (one-of/c 'posn 'draw-on/color 'touching? 'move-toward)))
      (res
       (msg)
       (cond
        ((equal? msg 'posn) (-> posn/c))
        ((equal? msg 'draw-on/color) (-> string? _image? _image?))
        ((equal? msg 'touching?) (-> posn/c boolean?))
        ((equal? msg 'move-toward) (-> posn/c zombie/c))
        (else "error")))))
    (define-ctc
     horde/c
     (->i
      ((msg
        (one-of/c 'dead 'undead 'draw-on 'touching? 'move-toward 'eat-brains)))
      (res
       (msg)
       (cond
        ((equal? msg 'dead) (-> zombies/c))
        ((equal? msg 'undead) (-> zombies/c))
        ((equal? msg 'draw-on) (-> _image? _image?))
        ((equal? msg 'touching?) (-> posn/c boolean?))
        ((equal? msg 'move-toward) (-> posn/c horde/c))
        ((equal? msg 'eat-brains) (-> horde/c))
        (else "error")))))
    (define-ctc
     zombies/c
     (->i
      ((msg (one-of/c 'move-toward 'draw-on/color 'touching? 'kill-all)))
      (res
       (msg)
       (cond
        ((equal? msg 'move-toward) (-> posn/c zombies/c))
        ((equal? msg 'draw-on/color) (-> string? _image? _image?))
        ((equal? msg 'touching?) (-> posn/c boolean?))
        ((equal? msg 'kill-all) (-> zombies/c horde/c))
        (else "error")))))
    (define-ctc
     world/c
     (->i
      ((msg (one-of/c 'on-mouse 'on-tick 'to-draw 'stop-when)))
      (res
       (msg)
       (cond
        ((equal? msg 'on-mouse) (-> c:number? c:number? string? world/c))
        ((equal? msg 'on-tick) (-> world/c))
        ((equal? msg 'to-draw) (-> _image?))
        ((equal? msg 'stop-when) (-> boolean?))
        (else "error")))))
    (define (_new-world player mouse zombies)
      (λ (msg)
        (cond
         ((equal? msg 'on-mouse)
          (λ (x y me)
            (_new-world
             player
             (if (equal? me "leave") ((player 'posn)) (_new-posn x y))
             zombies)))
         ((equal? msg 'on-tick)
          (λ ()
            (_new-world
             ((player 'move-toward) mouse)
             mouse
             ((((zombies 'eat-brains)) 'move-toward) ((player 'posn))))))
         ((equal? msg 'to-draw)
          (λ () ((player 'draw-on) ((zombies 'draw-on) _MT-SCENE))))
         ((equal? msg 'stop-when)
          (λ () ((zombies 'touching?) ((player 'posn)))))
         (else "unknown message"))))
    (define (_new-player p)
      (λ (msg)
        (cond
         ((equal? msg 'posn) (λ () p))
         ((equal? msg 'move-toward)
          (λ (q) (_new-player ((p 'move-toward/speed) q _PLAYER-SPEED))))
         ((equal? msg 'draw-on) (λ (scn) ((p 'draw-on/image) _PLAYER-IMG scn)))
         (else "unknown message"))))
    (define (_new-horde undead dead)
      (λ (msg)
        (cond
         ((equal? msg 'dead) (λ () dead))
         ((equal? msg 'undead) (λ () undead))
         ((equal? msg 'draw-on)
          (λ (scn)
            ((undead 'draw-on/color)
             "yellow"
             ((dead 'draw-on/color) "black" scn))))
         ((equal? msg 'touching?)
          (λ (p) (or ((undead 'touching?) p) ((dead 'touching?) p))))
         ((equal? msg 'move-toward)
          (λ (p) (_new-horde ((undead 'move-toward) p) dead)))
         ((equal? msg 'eat-brains) (λ () ((undead 'kill-all) dead)))
         (else "unknown message"))))
    (define (_new-cons-zombies z r)
      (λ (msg)
        (cond
         ((equal? msg 'move-toward)
          (λ (p)
            (_new-cons-zombies ((z 'move-toward) p) ((r 'move-toward) p))))
         ((equal? msg 'draw-on/color)
          (λ (c s) ((z 'draw-on/color) c ((r 'draw-on/color) c s))))
         ((equal? msg 'touching?)
          (λ (p) (or ((z 'touching?) p) ((r 'touching?) p))))
         ((equal? msg 'kill-all)
          (λ (dead)
            (cond
             ((or ((r 'touching?) ((z 'posn))) ((dead 'touching?) ((z 'posn))))
              ((r 'kill-all) (_new-cons-zombies z dead)))
             (else
              (let ((res ((r 'kill-all) dead)))
                (_new-horde
                 (_new-cons-zombies z ((res 'undead)))
                 ((res 'dead))))))))
         (else "unknown message"))))
    (define (_new-mt-zombies)
      (λ (msg)
        (cond
         ((equal? msg 'move-toward) (λ (p) (_new-mt-zombies)))
         ((equal? msg 'draw-on/color) (λ (c s) s))
         ((equal? msg 'touching?) (λ (p) #f))
         ((equal? msg 'kill-all)
          (λ (dead) (_new-horde (_new-mt-zombies) dead)))
         (else "unknown message"))))
    (define (_new-zombie p)
      (λ (msg)
        (cond
         ((equal? msg 'posn) (λ () p))
         ((equal? msg 'draw-on/color)
          (λ (c s) ((p 'draw-on/image) (circle _ZOMBIE-RADIUS "solid" c) s)))
         ((equal? msg 'touching?) (λ (q) (c:<= ((p 'dist) q) _ZOMBIE-RADIUS)))
         ((equal? msg 'move-toward)
          (λ (q) (_new-zombie ((p 'move-toward/speed) q _ZOMBIE-SPEED))))
         (else "unknown message"))))
    (define (_new-posn x y)
      (λ (msg)
        (let ((this (_new-posn x y)))
          (cond
           ((equal? msg 'x) (λ () x))
           ((equal? msg 'y) (λ () y))
           ((equal? msg 'posn) (λ () this))
           ((equal? msg 'move-toward/speed)
            (λ (p speed)
              (let* ((δx (c:- ((p 'x)) x))
                     (δy (c:- ((p 'y)) y))
                     (move-distance
                      (c:min speed (c:max (c:abs δx) (c:abs δy)))))
                (cond
                 ((c:< (c:abs δx) (c:abs δy))
                  ((this 'move)
                   (c:racket-number->c 0)
                   (if (positive? δy)
                     move-distance
                     (c:- (c:racket-number->c 0) move-distance))))
                 (else
                  ((this 'move)
                   (if (positive? δx)
                     move-distance
                     (c:- (c:racket-number->c 0) move-distance))
                   (c:racket-number->c 0)))))))
           ((equal? msg 'move) (λ (δx δy) (_new-posn (c:+ x δx) (c:+ y δy))))
           ((equal? msg 'draw-on/image)
            (λ (img scn) (place-image img x y scn)))
           ((equal? msg 'dist)
            (λ (p)
              (c:sqrt (c:+ (sqr (c:- ((p 'y)) y)) (sqr (c:- ((p 'x)) x))))))
           (else "unknown message")))))
    (define-id-with-ctc
     (-> player/c posn/c horde/c world/c)
     _new-world
     new-world
     bug
     bug)
    (define-id-with-ctc (-> posn/c player/c) _new-player new-player bug bug)
    (define-id-with-ctc
     (-> zombies/c zombies/c horde/c)
     _new-horde
     new-horde
     bug
     bug)
    (define-id-with-ctc
     (-> zombie/c zombies/c zombies/c)
     _new-cons-zombies
     new-cons-zombies
     bug
     bug)
    (define-id-with-ctc (-> zombies/c) _new-mt-zombies new-mt-zombies bug bug)
    (define-id-with-ctc (-> posn/c zombie/c) _new-zombie new-zombie bug bug)
    (define-id-with-ctc
     (-> c:number? c:number? posn/c)
     _new-posn
     new-posn
     bug
     bug)
    ((apply-ctc
      (-> (-> c:number? c:number? posn/c) dont-care/c)
      (convert-it
       |•(0 (->s (->s (list/s integer integer integer integer) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote move-toward/speed)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer) (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))))) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s (->si ((msg (one-of/c (quote x) (quote y) (quote posn) (quote move-toward/speed) (quote draw-on/image) (quote dist)))) (res (msg) (cond ((equal? msg (quote x)) (->s (list/s integer integer integer integer))) ((equal? msg (quote y)) (->s (list/s integer integer integer integer))) ((equal? msg (quote posn)) (->s none/s)) ((equal? msg (quote move-toward/speed)) (->s none/s (list/s integer integer integer integer) none/s)) ((equal? msg (quote draw-on/image)) (->s (struct/s _image any/s) (struct/s _image any/s) (struct/s _image any/s))) ((equal? msg (quote dist)) (->s none/s (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error")))) (list/s integer integer integer integer))) (else "error"))))) dont-care/s) (-> (-> number? number? posn/c) dont-care/c))|
       (->s
        (->s
         (list/s integer integer integer integer)
         (list/s integer integer integer integer)
         (->si
          ((msg
            (one-of/c 'x 'y 'posn 'move-toward/speed 'draw-on/image 'dist)))
          (res
           (msg)
           (cond
            ((equal? msg 'x) (->s (list/s integer integer integer integer)))
            ((equal? msg 'y) (->s (list/s integer integer integer integer)))
            ((equal? msg 'posn)
             (->s
              (->si
               ((msg
                 (one-of/c
                  'x
                  'y
                  'posn
                  'move-toward/speed
                  'draw-on/image
                  'dist)))
               (res
                (msg)
                (cond
                 ((equal? msg 'x)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'y)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'posn)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'move-toward/speed)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'draw-on/image)
                  (->s
                   (struct/s _image any/s)
                   (struct/s _image any/s)
                   (struct/s _image any/s)))
                 ((equal? msg 'dist)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)))
                 (else "error"))))))
            ((equal? msg 'move-toward/speed)
             (->s
              (->si
               ((msg
                 (one-of/c
                  'x
                  'y
                  'posn
                  'move-toward/speed
                  'draw-on/image
                  'dist)))
               (res
                (msg)
                (cond
                 ((equal? msg 'x)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'y)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'posn)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'move-toward/speed)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'draw-on/image)
                  (->s
                   (struct/s _image any/s)
                   (struct/s _image any/s)
                   (struct/s _image any/s)))
                 ((equal? msg 'dist)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)))
                 (else "error"))))
              (list/s integer integer integer integer)
              (->si
               ((msg
                 (one-of/c
                  'x
                  'y
                  'posn
                  'move-toward/speed
                  'draw-on/image
                  'dist)))
               (res
                (msg)
                (cond
                 ((equal? msg 'x)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'y)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'posn)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'move-toward/speed)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'draw-on/image)
                  (->s
                   (struct/s _image any/s)
                   (struct/s _image any/s)
                   (struct/s _image any/s)))
                 ((equal? msg 'dist)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)))
                 (else "error"))))))
            ((equal? msg 'draw-on/image)
             (->s
              (struct/s _image any/s)
              (struct/s _image any/s)
              (struct/s _image any/s)))
            ((equal? msg 'dist)
             (->s
              (->si
               ((msg
                 (one-of/c
                  'x
                  'y
                  'posn
                  'move-toward/speed
                  'draw-on/image
                  'dist)))
               (res
                (msg)
                (cond
                 ((equal? msg 'x)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'y)
                  (->s (list/s integer integer integer integer)))
                 ((equal? msg 'posn)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'move-toward/speed)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))))
                 ((equal? msg 'draw-on/image)
                  (->s
                   (struct/s _image any/s)
                   (struct/s _image any/s)
                   (struct/s _image any/s)))
                 ((equal? msg 'dist)
                  (->s
                   (->si
                    ((msg
                      (one-of/c
                       'x
                       'y
                       'posn
                       'move-toward/speed
                       'draw-on/image
                       'dist)))
                    (res
                     (msg)
                     (cond
                      ((equal? msg 'x)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'y)
                       (->s (list/s integer integer integer integer)))
                      ((equal? msg 'posn) (->s none/s))
                      ((equal? msg 'move-toward/speed)
                       (->s
                        none/s
                        (list/s integer integer integer integer)
                        none/s))
                      ((equal? msg 'draw-on/image)
                       (->s
                        (struct/s _image any/s)
                        (struct/s _image any/s)
                        (struct/s _image any/s)))
                      ((equal? msg 'dist)
                       (->s none/s (list/s integer integer integer integer)))
                      (else "error"))))
                   (list/s integer integer integer integer)))
                 (else "error"))))
              (list/s integer integer integer integer)))
            (else "error")))))
        dont-care/s)
       L
       #:arithmetic-coercion-both)
      bad-input
      no-blame
      |wrap new-posn|)
     new-posn))))
(define (counterexample)
  (define test-result
    (concolic-test
     new-posn
     #:all?
     #f
     #:strategy
     (simple-destructor-adapter
      (ignore-locals-adapter (simple-prioritize-branch-strategy 1000)))
     #:statistics?
     #t))
  (define witness (list-ref test-result 0))
  (define stats (list-ref test-result 1))
  (vector
   (concretize-input new-posn witness)
   '('dist 'draw-on/image 'move-toward/speed 'posn 'x 'y)
   `#hash((solve-count . ,(concolic-statistics-solve-count stats))
          (solve-real-nongc-time
           .
           ,(concolic-statistics-solve-real-nongc-time stats))
          (test-count . ,(concolic-statistics-test-count stats)))))
(provide counterexample (rename-out (new-posn test-property)))
(module+ main (counterexample))
